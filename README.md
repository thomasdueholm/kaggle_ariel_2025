# 4th place winning solution for NeurIPS - Ariel Data Challenge 2025

Competition: https://www.kaggle.com/competitions/ariel-data-challenge-2025

Documentation can be found in model_summary/model_summary.pdf.

## Hardware and OS/platform

- CPU specs: Intel Core Ultra 9 285K, base frequency 3.7 GHz
- Number of CPU cores: 24 cores
- Memory: 96 GB
- GPU specs: RTX 5090, 32 GB RAM
- Number of GPUs: 1
- OS/platform: Ubuntu 24.04.3 LTS

## Training

The steps for training my model are as follows. For each step the generated files are listed.

    python src/generate_raw_data.py train
        - cache/train_star_info.csv
        - cache/train_airs_data.npy
        - cache/train_fgs1_data.npy

    python src/generate_depth_estimation.py train
        - cache/train_depth_info.csv
    
    python src/generate_limb_darkening.py train
        - cache/train_limb_darkening.csv
        - cache/train_r_airs_limb_darkening.npy
        - cache/train_u_airs_limb_darkening.npy

    python src/train_models.py
        - Model checkpoints are saved in the models folder

The steps are also outlined in entry_points.md. The steps must be executed in this order, since each step relies on data generated by the previous step.
The first step performs calibration of raw data. The second step creates an initial solution which is used as the starting point for computation
in the third step. The third step generates features for the model that is then trained in the fourth step.

## Predictions

The steps for generating predictions are as follows. Generated files are again listed for each step.

    python src/generate_raw_data.py test
        - cache/test_star_info.csv
        - cache/test_airs_data.npy
        - cache/test_fgs1_data.npy

    python src/generate_depth_estimation.py test
        - cache/test_depth_info.csv

    python src/generate_limb_darkening.py test
        - cache/test_limb_darkening.csv
        - cache/test_r_airs_limb_darkening.npy
        - cache/test_u_airs_limb_darkening.npy

    python src/generate_submission.py test
        - submissions/submission.csv

The first three steps are the same as for training, except with a new test set. The fourth step applies the trained model and generates submission.csv.

## Hyperparameters

Hyperparameters are described in the files:

    parameters/config.json
    parameters/kaggle_config.json

The first file is used for training and the second file is used for predictions. The files are identical, except for batch sizes, which are set to
use 32 GB of GPU RAM for training and 16 GB of GPU RAM for predictions. 

## Side effects

Whenever data is read from or written to a file, which is always done via util.py, an empty directory for the file is created if it is not 
already present. The original data in the data directory (RAW_DATA_DIR) is never changed. There are no assumptions about output folders
being empty. Instead existing data is overwritten.
